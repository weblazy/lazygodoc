# 扩散读还是扩散写

1. 扩散写: 假设一个群(gid)里有100个成员。A发送了一条消息，很容易想到，对于不同的群友消息存多份，每个群友一个队列来存储。这样的话,会时同一条消息复制了一百份,群消息特别多的时候,这个消息量的存储是特别大的.(好处:当用户拉取离线消息时可以一次拉取所有群的未读消息,同一用户多个群在同一队列中.)

2. 扩散读: 利用群消息的"偏序"特性优雅地实现"只存1份",每个用户只需要记录"最近一次收到的消息ID"，而不用记录
所有未收到的消息ID集合"，每当收在线消息ack，以及拉离线消息ack时，只需要更新这个"最近一次收到的消息ID"即可。群聊消息存一份，只存last_ack_msgid。(好处就是:每条消息只存储一条,消息量大大减少,缺点:每个群的未读消息需要单独拉取与记录,因为各自的未读位点不同)

3. 建议: 群成员极少的情况下可以考虑扩散写,如一对一聊天可以当做两个人的群,如果是群成员特别多建议使用扩散读方案.
